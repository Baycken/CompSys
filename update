#!/bin/bash
#
# Update vim plugins and apt, gem and pip dependencies

#########################################
# Get dependencies from /packages
# Arguments:
#   File in /packages
# Returns:
#   Space separated list of dependencies
#########################################
function get_dependencies () {
  if [[ -s ${ROBOTIC_PATH}/compsys/packages/$1 ]]; then
    cat ${ROBOTIC_PATH}/compsys/packages/$1 | awk 'BEGIN{ORS=" "}1'
  fi
}

if [[ -d ${HOME}/.vim/bundle/Vundle.vim ]]; then
  echo " * Updating vim plugins..."
  vim +PluginInstall +qall
fi

echo " * Updating apt dependencies..."
apt=$(get_dependencies apt)
[[ -n "${apt}" ]] && sudo apt-get -y -qq install ${apt} || :

echo " * Updating gem dependencies..."
gem=$(get_dependencies gem)
[[ -n "${gem}" ]] && sudo gem install -q ${gem} > /dev/null || :

echo " * Updating pip dependencies..."
pip=$(get_dependencies pip)
[[ -n "${pip}" ]] && sudo pip install --upgrade ${pip} > /dev/null || :

echo "   ...done."
echo
